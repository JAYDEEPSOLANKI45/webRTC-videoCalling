# WebRTC Video Calling App

A secure, modern video calling web application built with Node.js, Express, Socket.IO, and WebRTC. This project demonstrates peer-to-peer video communication with signaling via Socket.IO, HTTPS encryption using local certificates, and TURN/STUN server configuration via Twilio for robust NAT traversal.

## Features
- **Secure HTTPS**: Uses locally generated certificates (via `mkcert`) for encrypted communication.
- **WebRTC Peer Connections**: Real-time video/audio streaming between users.
- **Socket.IO Signaling**: Handles room joining, offer/answer exchange, and ICE candidate relay.
- **Twilio TURN/STUN**: Dynamically fetches ICE server credentials from Twilio for reliable connectivity.

## Project Structure
```
webRTC/
├── localhost+1-key.pem         # HTTPS private key (generated by mkcert)
├── localhost+1.pem             # HTTPS certificate (generated by mkcert)
├── mkcert.exe                  # Tool for generating local certs
├── package.json                # Node.js dependencies and scripts
├── server.js                   # Main Express/Socket.IO server
├── views/
│   └── index.ejs               # Main UI template
```

## Setup Instructions

### 1. Install Dependencies
```bash
npm install
```

### 2. Generate HTTPS Certificates
This app uses HTTPS for secure signaling. Certificates are generated using [`mkcert`](https://github.com/FiloSottile/mkcert):

1. Place `mkcert.exe` in the project root.
2. Run the following commands in your project directory:
   ```cmd
   mkcert -install
   mkcert localhost
   ```
   This will create `localhost+1.pem` and `localhost+1-key.pem`.

### 3. Configure Environment Variables
Create a `.env` file in the root with your Twilio credentials and ICE server details:
```
TWILIO_ACCOUNT_SID=your_account_sid
TWILIO_AUTH_TOKEN=your_auth_token
urls1=stun:global.stun.twilio.com:3478?transport=udp
urls2=turn:global.turn.twilio.com:3478?transport=udp
urls3=turn:global.turn.twilio.com:3478?transport=tcp
urls4=turn:global.turn.twilio.com:443?transport=tcp
user_name=your_twilio_username
credential=your_twilio_credential
```

### 4. Start the Server
```bash
node server.js
```
Visit [https://localhost:3000](https://localhost:3000) in your browser.

### 5. Connect Across Devices Using Ngrok
To allow devices outside your local network to access your server, use [ngrok](https://ngrok.com/) to create a secure HTTPS tunnel:

1. Download and install ngrok from [ngrok.com](https://ngrok.com/download).
2. Start your Node.js server as shown above.
3. In a new terminal, run:
   ```cmd
   ngrok http https://localhost:3000
   ```
4. Ngrok will provide a public HTTPS URL (e.g., `https://xxxx.ngrok.io`). Share this URL with remote devices to access your app securely.

**Note:**
- Your local HTTPS certificates are still used between ngrok and your server.
- For best results, keep ngrok running while testing across devices.

## How It Works
- **HTTPS**: The server runs over HTTPS using locally trusted certificates for development.
- **Signaling**: Socket.IO manages signaling (room join, offer/answer, ICE candidates) between peers.
- **WebRTC**: The frontend (`index.ejs`) establishes peer connections and streams video/audio.
- **Twilio TURN/STUN**: The server fetches ICE server credentials from Twilio, ensuring connectivity even behind NAT/firewalls.

## Notes
- Twilio credentials are required for TURN server access. See [Twilio docs](https://www.twilio.com/docs/stun-turn) for details.
- `mkcert` is used for local HTTPS only. self-signed certificates are not used in production

- To connect with devices outside your LAN, use `ngrok` as described above. This is ideal for demos, testing, and development.
